{
  "GUID": "88a2c3",
  "Name": "Custom_Token",
  "Transform": {
    "posX": 20.7480927,
    "posY": 1.54865336,
    "posZ": -13.3487158,
    "rotX": 0.0169036575,
    "rotY": 179.978088,
    "rotZ": 0.07987046,
    "scaleX": 0.9942721,
    "scaleY": 1,
    "scaleZ": 0.9942721
  },
  "Nickname": "Turn Order",
  "Description": "",
  "GMNotes": "",
  "AltLookAngle": {
    "x": 0,
    "y": 0,
    "z": 0
  },
  "ColorDiffuse": {
    "r": 0.5476362,
    "g": 0.712397933,
    "b": 0.900696933
  },
  "LayoutGroupSortIndex": 0,
  "Value": 0,
  "Locked": true,
  "Grid": true,
  "Snap": true,
  "IgnoreFoW": false,
  "MeasureMovement": false,
  "DragSelectable": true,
  "Autoraise": true,
  "Sticky": true,
  "Tooltip": false,
  "GridProjection": false,
  "HideWhenFaceDown": false,
  "Hands": false,
  "CustomImage": {
    "ImageURL": "https://steamusercontent-a.akamaihd.net/ugc/2064382397819475215/1F01DF607984A43D89C19C61C13D854FE2812A19/",
    "ImageSecondaryURL": "",
    "ImageScalar": 1,
    "WidthScale": 0,
    "CustomToken": {
      "Thickness": 0.2,
      "MergeDistancePixels": 15,
      "StandUp": false,
      "Stackable": false
    }
  },
  "LuaScript": "myDeck = 'd3724a'\r\nmyDiscard = '74276a'\r\nmyTimer = ''\r\ncanContinue = true\r\n\r\nfourPlayer = false\r\nthreePlayer = false\r\n\r\nfunction onLoad()\r\n  button = {click_function = 'nextTurn',\r\n                                function_owner = self,\r\n                                label = 'Next Turn',\r\n                                position = {0,0.1,0},\r\n                                rotation = {0,0,0},\r\n                                width = 2000,\r\n                                height = 750,\r\n                                font_size = 200,\r\n                                tooltip = \"Flip the deck turn order card. Flips and shuffles automatically if deck is empty.\",\r\n                                color = {r=0.5,b=0.5,g=1}\r\n\r\n          }  -- body...\r\n    self.createButton(button)\r\n    self.setLock(true)\r\nend\r\n\r\nfunction nextTurn()\r\n  if (canContinue == false) then\r\n    return(nil)\r\n  end\r\n  deckObject = getObjectFromGUID(myDeck)\r\n  discardObject = getObjectFromGUID(myDiscard)\r\n  findDeck = findDecksInZone(deckObject)\r\n  findDiscard = findDecksInZone(discardObject)\r\n  if findDeck == nil and findDiscard == nil then\r\n    broadcastToAll(\"There is no turn order deck or discard pile!\", {r = 1, g = 0, b = 0})\r\n    return(nil)\r\n  end\r\n\r\n  local pos = discardObject.getPosition() + vector(0,1.5,0)\r\n  local rot = {0,180,0}\r\n  deckParam = {position = pos,rotation = rot, smooth = true}\r\n  if findDeck ~= nil then\r\n    if (findDeck.tag == \"Deck\") then\r\n      findDeck.takeObject(deckParam)\r\n    elseif (findDeck.tag == \"Card\") then\r\n      findDeck.setPositionSmooth(pos)\r\n      findDeck.setRotationSmooth(rot)\r\n    end\r\n    canContinue = false\r\n    Wait.time(flipBool,1)\r\n  else\r\n    if (findDiscard ~= nil) then\r\n      findDiscard.setPositionSmooth(deckObject.getPosition() + vector(0,1.5,0))\r\n      findDiscard.setRotation({0,180,180})\r\n      findDiscard.shuffle()\r\n      findDiscard.setName(\"Turn Order Deck\")\r\n      canContinue = false\r\n      if fourPlayer == true then\r\n        local token1 = getObjectFromGUID('373770')\r\n        local token2 = getObjectFromGUID('dc4292')\r\n        token1.setPositionSmooth({2.04, 3.78, -17.92})\r\n        token1.setRotation({0,180,0})\r\n        token2.setPositionSmooth({-2.04, 3.78, -17.92})\r\n        token2.setRotation({0,180,0})\r\n      end\r\n      if threePlayer == true then\r\n        local token3 = getObjectFromGUID('1b87f7')\r\n        local myPos = token3.getPosition()\r\n        if myPos.x  > 48 then\r\n          token3.setPositionSmooth({25.06, 5.64, -30.74}, false, true)\r\n        else if myPos.x > 0 then\r\n          token3.setPositionSmooth({-24.94, 5.64, -30.74}, false, true)\r\n        else\r\n            token3.setPositionSmooth({70.07, 5.64, -30.74}, false, true)\r\n        end\r\n        token3.setRotation({0,180,0})\r\n      end\r\n      end\r\n      Wait.time(flipBool,0.5)\r\n      Wait.time(nextTurn,0.5)\r\n    else\r\n      broadcastToAll(\"There is no turn order deck or discard pile!\", {r = 1, g = 0, b = 0})\r\n      return(nil)\r\n    end\r\n  end\r\nend\r\n\r\nfunction flipBool()\r\n  canContinue = true\r\nend\r\n\r\nfunction findDecksInZone(zone)\r\n    local objectsInZone = zone.getObjects()\r\n    local decksFound = {}\r\n    for i, object in ipairs(objectsInZone) do\r\n        if object.tag == \"Deck\" or object.tag == \"Card\" then\r\n            return getObjectFromGUID(object.guid)\r\n        end\r\n    end\r\n    if #decksFound > 0 then\r\n        return decksFound\r\n    else\r\n        return nil\r\n    end\r\nend",
  "LuaScriptState": "",
  "XmlUI": ""
}